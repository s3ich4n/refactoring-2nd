# 4장 - 테스트 구축하기

가치있는 리팩터링을 위해서는 불가피한 실수 대비용 완충재가 필요하다. 그것이 테스트 스위트(_test suite_)이다. 책에서 소개하는 리팩터링 대다수는 테스트 스위트로 검증하길 제안한다. 왜
좋은지 저자의 설명을 요약해보자.

## 4.1 자가 테스트코드의 가치

프로그래머는 코드 짜는 것보다 디버깅하는데 시간을 많이 쓴다. 버그는 몇줄 그냥 고치고 끝인데, 그 여정이 매우 길다. 그리고 버그 잡다가 또 버그가 생긴다. 마틴 파울러도 일하면서 테스트코드를
담기로 했는데, 이 때 자동화가 뒷받침되게끔 각잡고 하자고 마음먹은 후 이렇게 결심했다:

> 모든 테스트는 완전 자동화. 결과도 스스로 검사되게끔.

이걸 하니까 회귀 버그 잡는것에 시간을 거의 덜 쏟았다.

> 테스트 스위트는 버그검출 도구다. 버그를 찾는 시간을 대폭 줄여준다.

켄트 백과 에릭 감마[^1]가 비행기 타고 날아가면서 뚝딱 만든 프로그램이 있다. 그게 저 유명한 JUnit이다. `xUnit` 식구들 의 영향을 받은 `unittest`가 파이썬의 기본 테스트
검출기고, 내가 쓰는 `pytest` 는 파이썬 스러운 성향을 더 띈다.

테스트 작성법을 알아야 하고, 테스트를 자동화할 수 있어야 하고, 테스트를 처음부터 짜고 쌓아올라가는 편이 좋다[^2]. 내가 만드는 기능의 계약을 테스트로 구성하고(이 때 테스트 run하면
당연히 Fail이다. 코드베이스가 없거나 바뀐 조건에서 패스하는거니까), 코드베이스를 고치고 테스트를 Pass로 바꾼다. 그리고 리팩터링을 여기서 적용.

## 4.2 테스트할 샘플 코드

이런 사진이 있는데 비즈니스로직만 먼저 짜고 테스트해보자.

[^1]: GoF 의 그 사나이.
[^2]: 그게 안 된다면 레거시 코드 활용 전략에서 제시하는 테스트 추가용 기법을 배우면 좋겠다. <br /> https://m.yes24.com/Goods/Detail/64586851